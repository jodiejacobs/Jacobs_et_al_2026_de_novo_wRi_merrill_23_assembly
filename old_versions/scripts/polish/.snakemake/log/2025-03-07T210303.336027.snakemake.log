host: emerald.prism
Building DAG of jobs...
SLURM run ID: fc516169-1755-4e1f-bd0f-029ba8b0ea6a
Using shell: /usr/bin/bash
Provided remote nodes: 10
Job stats:
job                                   count
----------------------------------  -------
all                                       1
attempt_circularization                   1
bam2fastq_illumina                        1
close_gaps                                1
polish_scaffolded_with_short_reads        1
total                                     5

Select jobs to execute...
Execute 1 jobs...

[Fri Mar  7 21:03:04 2025]
rule bam2fastq_illumina:
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi.bam
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_singleton.fastq.gz
    jobid: 10
    reason: Missing output files: /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz
    threads: 8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=<TBD>, slurm_partition=medium, runtime=200

No SLURM account given, trying to guess.
Guessed SLURM account: standard
Job 10 has been submitted with SLURM jobid 6792999 (log: /private/groups/russelllab/jodie/merrill_23_wRi_genome/de_novo_wRi_merrill_23_assembly/scripts/polish/.snakemake/slurm_logs/rule_bam2fastq_illumina/6792999.log).
[Fri Mar  7 21:03:45 2025]
Finished job 10.
1 of 5 steps (20%) done
Select jobs to execute...
Execute 1 jobs...

[Fri Mar  7 21:03:45 2025]
rule polish_scaffolded_with_short_reads:
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/links_pilon.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/tgs_pilon.fasta
    jobid: 3
    reason: Missing output files: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/tgs_pilon.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/links_pilon.fasta; Input files updated by another job: /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz
    wildcards: sample=merrill_23_all_basecalled
    threads: 16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=<TBD>, slurm_partition=medium, runtime=360

Job 3 has been submitted with SLURM jobid 6793018 (log: /private/groups/russelllab/jodie/merrill_23_wRi_genome/de_novo_wRi_merrill_23_assembly/scripts/polish/.snakemake/slurm_logs/rule_polish_scaffolded_with_short_reads/merrill_23_all_basecalled/6793018.log).
[Fri Mar  7 21:05:25 2025]
Error in rule polish_scaffolded_with_short_reads:
    message: SLURM-job '6793018' failed, SLURM status is: 'FAILED'. For further error details see the cluster/cloud log and the log files of the involved rule(s).
    jobid: 3
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz, /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/links_pilon.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/tgs_pilon.fasta
    log: /private/groups/russelllab/jodie/merrill_23_wRi_genome/de_novo_wRi_merrill_23_assembly/scripts/polish/.snakemake/slurm_logs/rule_polish_scaffolded_with_short_reads/merrill_23_all_basecalled/6793018.log (check log file(s) for error details)
    shell:
        
        # Create output directory
        mkdir -p /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/
        
        # Index the scaffolded assemblies
        bwa index /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta
        bwa index /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
        
        # Map reads to LINKS scaffolds and polish
        bwa mem -t 16 /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz |             samtools sort -@ 16 -o /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//links_sorted.bam
        samtools index -@ 16 /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//links_sorted.bam
        
        pilon --genome /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta               --frags /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//links_sorted.bam               --output links_pilon               --outdir /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/               --threads 16               --changes --vcf
              
        # Map reads to TGS scaffolds and polish
        bwa mem -t 16 /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R1.fastq.gz /private/groups/russelllab/jodie/merrill_23_wRi_genome/short_reads/wRi_R2.fastq.gz |             samtools sort -@ 16 -o /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//tgs_sorted.bam
        samtools index -@ 16 /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//tgs_sorted.bam
        
        pilon --genome /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta               --frags /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//tgs_sorted.bam               --output tgs_pilon               --outdir /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/               --threads 16               --changes --vcf
        
        # Rename outputs to match expected paths
        mv /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//links_pilon.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/links_pilon.fasta
        mv /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi//tgs_pilon.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished_scaffolds/merrill_23_all_basecalled/wRi/tgs_pilon.fasta
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    external_jobid: 6793018

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-03-07T210303.336027.snakemake.log
WorkflowError:
At least one job did not complete successfully.
