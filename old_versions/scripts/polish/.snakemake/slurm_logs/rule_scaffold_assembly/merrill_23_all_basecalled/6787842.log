host: phoenix-10.prism
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided remote nodes: 1
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954
Conda environments: ignored
Select jobs to execute...
Execute 1 jobs...

[Fri Mar  7 18:13:45 2025]
rule scaffold_assembly:
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
    jobid: 0
    reason: Forced execution
    wildcards: sample=merrill_23_all_basecalled
    threads: 16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=<TBD>, slurm_partition=medium, runtime=360

host: phoenix-10.prism
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 16
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954
Conda environments: ignored
Select jobs to execute...
Execute 1 jobs...

[Fri Mar  7 18:13:46 2025]
localrule scaffold_assembly:
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
    jobid: 0
    reason: Forced execution
    wildcards: sample=merrill_23_all_basecalled
    threads: 16
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/data/tmp, slurm_partition=medium, runtime=360


Running Command: LINKS-make LINKS draft=/private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta readsFof=/private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt  k=19 t=5       b=/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links     
LINKS_CPP -f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta -s /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt   -d 4000 -k 19 -t 5 -j 3 -l 5 -o 0 -e 0.1 -z 500 -p 0.001 -b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links -v 0 -x 0

LINKS running options:
  -f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta
  -s /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt
  -d 4000
  -k 19
  -j 3
  -t 5
  -o 0
  -e 0.1
  -l 5
  -a 0.3
  -z 500
  -b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links
  -r 
  -p 0.001
  -x 0
  -v 0

STAGE: Bloom filter construction/read
- Number of BF Elements: 1424239
- Input file path: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links
- Input file: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta
- kmersize: 19
- m: 20477128
- fpr: 0.001
- hashFct: 9
- Filter output file : 19


Writing Bloom filter to disk (/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.bloom)
Bloom filter generated or loaded in: 0h 0m 0s 105ms

STAGE: Reading sequence reads
Reading: /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz
Processed read count: 100000 - 200000 - 300000 - 400000 - 500000 - 600000 - 672771
Read fasta stage completed in: 0h 0m 5s 251ms

STAGE: Reading contigs
Reading: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta
Processed read count: 21
Read contig stage completed in: 0h 0m 0s 965ms

STAGE: Pairing contigs
All contig pairs traversed

===========PAIRED K-MER STATS===========
At least one sequence/pair missing from contigs: 19
Ambiguous kmer pairs (both kmers are ambiguous): 540090
Assembled pairs: 0 (0 sequences)
	Satisfied in distance/logic within contigs (i.e. -> <-, distance on target): 1232335
	Unsatisfied in distance within contigs (i.e. distance out-of-bounds): 3071
	Unsatisfied pairing logic within contigs (i.e. illogical pairing ->->, <-<- or <-->): 52379
	---
	Satisfied in distance/logic within a given contig pair (pre-scaffold): 92280
	Unsatisfied in distance within a given contig pair (i.e. calculated distances out-of-bounds): 8032
	---
Total satisfied: 1324615	unsatisfied: 63482
============================================

Pair contig stage completed in: 0h 0m 1s 227ms

LINKS.pl -f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta -s empty.fof -b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links -l 5 -a 0.3 -e 0.1 -z 500 -p 0.001 -v 0

Running: /private/home/jomojaco/mambaforge/envs/snakemake_v8/bin/LINKS.pl [v1.8.6]
-f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta
-m 0
-d 4000
-k 15
-e 0.1
-l 5
-a 0.3
-t 2
-o 0
-z 500
-b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links
-r 
-p 0.001
-x 0

----------------- Verifying files -----------------

Checking sequence target file /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta...ok


Scaffolding mid-point files:
/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.tigpair_checkpoint.tsv
/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.simplepair_checkpoint.tsv
detected; LINKS will skip contig pairing and use info from files instead : Fri Mar  7 06:14:02 PM PST 2025

Reading sequences from /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta : Fri Mar  7 06:14:02 PM PST 2025

done.
Reading sequence pairs from /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.tigpair_checkpoint.tsv : Fri Mar  7 06:14:02 PM PST 2025

done.
Building scaffolds : Fri Mar  7 06:14:02 PM PST 2025

done.
Building .gv graph : Fri Mar  7 06:14:02 PM PST 2025


=>Scaffolding ended : Fri Mar  7 06:14:02 PM PST 2025
Scaffolds layout in: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.scaffolds
Scaffold graph in: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.gv


=>Making FASTA file : Fri Mar  7 06:14:02 PM PST 2025
Scaffolds FASTA in : /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.scaffolds.fa


=>Wrote correspondence file tracking LINKScontigID <=> OriginalContigNames : /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.assembly_correspondence.tsv

Scaffolding executed normally Fri Mar  7 06:14:02 PM PST 2025
/private/home/jomojaco/mambaforge/envs/snakemake_v8/bin/LINKS.pl [v1.8.6] terminated successfully on Fri Mar  7 06:14:02 PM PST 2025
INFO  :   Run tgsgapcloser. from /private/home/jomojaco/mambaforge/envs/snakemake_v8/bin ;
          Version : 1.2.1 ;
          Release time : 2022-12-30 .


INFO  :   Parsing args starting ...
getopt: unrecognized option '--scaffold'
getopt: unrecognized option '--tmp'
             --reads /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi//nanopore_reads.fastq
             --output /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out
             --thread 16
             --min_match 0.3
             --ne 
             --tgstype ont

INFO  :   Parsing args end .

INFO  :   Checking basic args & env ...

FATAL :   Arg input_scaff is not assigned !!! ! exit ...
 try -h/--help for usage.
cp: cannot stat '/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out/gap_filled.fasta': No such file or directory
[Fri Mar  7 18:14:02 2025]
Error in rule scaffold_assembly:
    jobid: 0
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
    shell:
        
        # Create output directory
        mkdir -p /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/
        mkdir -p /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tmp
        
        # Extract reads from gzipped file
        zcat /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz > /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi//nanopore_reads.fastq
        
        # Approach 1: LINKS scaffolder
        echo /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz > /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt
        LINKS -f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta -s /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt -b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links -t 5 -k 19
        
        # Move the final LINKS output to expected location
        cp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.scaffolds.fa /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta
        
        # Approach 2: TGS-GapCloser (replacing SSPACE)
        tgsgapcloser             --scaffold /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta             --reads /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi//nanopore_reads.fastq             --output /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out             --thread 16             --min_match 0.3             --ne             --tgstype ont             --tmp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tmp
        
        # Move the TGS-GapCloser output to expected location
        cp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out/gap_filled.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job scaffold_assembly since they might be corrupted:
/private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Storing output in storage.
WorkflowError:
At least one job did not complete successfully.
srun: error: phoenix-10: task 0: Exited with exit code 1
[Fri Mar  7 18:14:02 2025]
Error in rule scaffold_assembly:
    jobid: 0
    input: /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz
    output: /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta, /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
    shell:
        
        # Create output directory
        mkdir -p /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/
        mkdir -p /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tmp
        
        # Extract reads from gzipped file
        zcat /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz > /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi//nanopore_reads.fastq
        
        # Approach 1: LINKS scaffolder
        echo /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/basecalled/merrill_23_all_basecalled.wRi.fastq.gz > /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt
        LINKS -f /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta -s /private/groups/russelllab/jodie/merrill_23_wRi_genome/nanopore_data/read_list.txt -b /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links -t 5 -k 19
        
        # Move the final LINKS output to expected location
        cp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links.scaffolds.fa /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/links_scaffolded.fasta
        
        # Approach 2: TGS-GapCloser (replacing SSPACE)
        tgsgapcloser             --scaffold /private/groups/russelllab/jodie/merrill_23_wRi_genome/polished/merrill_23_all_basecalled/wRi/polished.fasta             --reads /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi//nanopore_reads.fastq             --output /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out             --thread 16             --min_match 0.3             --ne             --tgstype ont             --tmp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tmp
        
        # Move the TGS-GapCloser output to expected location
        cp /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_out/gap_filled.fasta /private/groups/russelllab/jodie/merrill_23_wRi_genome/scaffolded/merrill_23_all_basecalled/wRi/tgs_scaffolded.fasta
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Storing output in storage.
WorkflowError:
At least one job did not complete successfully.
